# Escalación de privilegios en WordPress

Existe un plugin (Extra User Details) que te permite añadir campos extra a la página de perfil del usuario (por ejemplo, enlaces a Facebook, Twitter, LinkedIn, etc.).
El plugin guarda los datos de los campos en la tabla wp_usermeta. Puedes agregar y editar campos adicionales en los ajustes del plugin desde el administrador de WordPress.

Este plugin sufre de una vulnerabilidad de escalación de privilegios.
El plugin usa un hook `eud_update_ExtraFields` para ejecutar la función `profile_update` de WordPress. Esta función no comprueba correctamente las capacidades o permisos del usuario, y actualiza toda los metadatos o información que se envía a los datos del post, en este caso el usuario.

La única condición es que el nombre de la variable del post tenga el prefijo `eud` que es eliminado antes de actualizar los valores en la base de datos.
Es por eso que es posible explotar este mal comportamiento para actualizar la variable de las capacidades de un usuario. Por ejemplo, {prefijo}_capabilities para obtener privilegios administrativos.

Para este exploit, se asume que en la base de datos del sitio de WordPress se usa el prefijo "wp_", que es el prefijo por defecto de las tablas de WordPress.
